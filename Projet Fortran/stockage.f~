      SUBROUTINE STOCKAGE(N,M,ITERATOR,SIZEMAX,AIJ,VECTEUR_DIAGONAL,
     A VECTEUR_TRIANGLE,VECTEUR_STOCKAGE)
      IMPLICIT NONE
      INTEGER  N,M,I,ITERATOR,SIZEMAX,VECTEUR_DIAGONAL(SIZEMAX),
     B VECTEUR_TRIANGLE((N+1)*(M+1)),
     C POSITIONVECT,MINLIGN,COLONNE
      REAL     AIJ(6),VECTEUR_STOCKAGE(SIZEMAX)

C     STOCKAGE AIJ  I=J
      POSITIONVECT=VECTEUR_DIAGONAL(VECTEUR_TRIANGLE(ITERATOR))
      VECTEUR_STOCKAGE(POSITIONVECT) = 
     Z VECTEUR_STOCKAGE(POSITIONVECT) + AIJ(1)
C      WRITE(*,*) '1 AII I:',VECTEUR_TRIANGLE(ITERATOR),' ',
C     C VECTEUR_STOCKAGE(POSITIONVECT)
      POSITIONVECT=VECTEUR_DIAGONAL(VECTEUR_TRIANGLE(ITERATOR+1))
      VECTEUR_STOCKAGE(POSITIONVECT) = 
     Z VECTEUR_STOCKAGE(POSITIONVECT) + AIJ(4)
C      WRITE(*,*) '2 AII I:',VECTEUR_TRIANGLE(ITERATOR+1),' ',
C     C VECTEUR_STOCKAGE(POSITIONVECT)
      POSITIONVECT=VECTEUR_DIAGONAL(VECTEUR_TRIANGLE(ITERATOR+2))
      VECTEUR_STOCKAGE(POSITIONVECT) = 
     Z VECTEUR_STOCKAGE(POSITIONVECT) + AIJ(6)
C      WRITE(*,*) '3 AII I:',VECTEUR_TRIANGLE(ITERATOR+2),' ',
C     C VECTEUR_STOCKAGE(POSITIONVECT)

C     STOCKAG AIJ I/=J
      MINLIGN = VECTEUR_TRIANGLE(ITERATOR)
      COLONNE = VECTEUR_TRIANGLE(ITERATOR+1)
C      WRITE(*,*) '----- AIJ12-----',MINLIGN,COLONNE
      IF(MINLIGN.GE.COLONNE) THEN
      POSITIONVECT = VECTEUR_DIAGONAL(MINLIGN)
      POSITIONVECT = POSITIONVECT-(MINLIGN-COLONNE)
      ENDIF

      IF(COLONNE.GE.MINLIGN) THEN
      POSITIONVECT = VECTEUR_DIAGONAL(COLONNE)
      POSITIONVECT = POSITIONVECT-(COLONNE-MINLIGN)
      ENDIF

C      WRITE(*,*) '-----POS1-------: ',POSITIONVECT
C      VECTEUR_STOCKAGE(POSITIONVECT) = 
     D VECTEUR_STOCKAGE(POSITIONVECT)+AIJ(2)

      MINLIGN = VECTEUR_TRIANGLE(ITERATOR)
      COLONNE = VECTEUR_TRIANGLE(ITERATOR+2)
C      WRITE(*,*) '-----AIJ13----',MINLIGN,COLONNE
      IF(MINLIGN.GE.COLONNE) THEN
      POSITIONVECT = VECTEUR_DIAGONAL(MINLIGN)
      POSITIONVECT = POSITIONVECT-(MINLIGN-COLONNE)
      ENDIF

      IF(COLONNE.GE.MINLIGN) THEN
      POSITIONVECT = VECTEUR_DIAGONAL(COLONNE)
      POSITIONVECT = POSITIONVECT-(COLONNE-MINLIGN)
      ENDIF
C      WRITE(*,*) '-----POS2-----',POSITIONVECT
C      VECTEUR_STOCKAGE(POSITIONVECT) = 
     E VECTEUR_STOCKAGE(POSITIONVECT)+AIJ(3)
      

      MINLIGN = VECTEUR_TRIANGLE(ITERATOR+1)
      COLONNE = VECTEUR_TRIANGLE(ITERATOR+2)
C      WRITE(*,*) '------AIJ23-----',MINLIGN,COLONNE
      IF(MINLIGN.GE.COLONNE) THEN
      POSITIONVECT=VECTEUR_DIAGONAL(MINLIGN)
      POSITIONVECT = POSITIONVECT-(MINLIGN-COLONNE)
      ENDIF
      IF(COLONNE.GE.MINLIGN) THEN
      POSITIONVECT = VECTEUR_DIAGONAL(COLONNE)
      POSITIONVECT = POSITIONVECT-(COLONNE-MINLIGN)
      ENDIF
C      WRITE(*,*) '------POS3----',POSITIONVECT
      VECTEUR_STOCKAGE(POSITIONVECT) = 
     F VECTEUR_STOCKAGE(POSITIONVECT)+AIJ(5)
      

   
      END
